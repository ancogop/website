<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   Local Representatives - Anderson County Republican Party
  </title>
  <!-- Basic SEO -->
  <meta content="Find your Local County, City, or School District Representative" name="description"/>
  <meta content="Anderson County, Republican Party, Kansas, Conservative, Local Elections, Community Engagement" name="keywords"/>
  <meta content="Anderson County Republican Party" name="author"/>
  <!-- Favicon -->
  <link href="images\elephant.png" rel="icon" type="image/png"/>
  <!-- Or you can use an ICO file -->
  <!-- <link rel="icon" href="favicon.ico" /> -->
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
  <!-- Your CSS -->
  <link href="style.css" rel="stylesheet"/>
  <!-- Optional: Open Graph tags for social media sharing -->
  <meta content="Local Representatives - Anderson County Republican Party" property="og:title"/>
  <meta content="Find your Local County, City, or School District Representative." property="og:description"/>
  <meta content="website" property="og:type"/>
  <meta content="https://ancogop.org/local-reps" property="og:url"/>
  <meta content="https://ancogop.org/images/elephant.png" property="og:image"/>
  <!-- Optional: Twitter Card tags -->
  <meta content="summary_large_image" name="twitter:card"/>
  <meta content="Local Representatives - Anderson County Republican Party" name="twitter:title"/>
  <meta content="Find your Local County, City, or School District Representative." name="twitter:description"/>
  <meta content="https://ancogop.org/images/elephant.png" name="twitter:image"/>
 </head>
 <body>
  <!--#include virtual="header.html" -->
  <main>
   <div class="header-with-search">
    <h2 class="page-title">
     Local Representatives
    </h2>
    <div class="table-controls">
     <input class="header-search" id="searchBox" placeholder="Search..." type="text"/>
    </div>
   </div>
   <div class="table-responsive">
    <table aria-label="Local Leaders Contact Information" class="local-leaders-table" id="leadersTable">
     <thead>
      <tr>
       <th>
        Name
       </th>
       <th>
        Position
       </th>
      </tr>
     </thead>
     <tbody>
     </tbody>
    </table>
    <div class="result-count" id="resultCount">
    </div>
   </div>
   <div class="pagination-wrapper">
    <div class="pagination-controls" id="pagination">
    </div>
    <div class="rows-wrapper">
     <select class="rows-per-page" id="rowsPerPage">
      <option value="5">
       5 per page
      </option>
      <option selected="" value="10">
       10 per page
      </option>
      <option value="25">
       25 per page
      </option>
      <option value="50">
       50 per page
      </option>
     </select>
    </div>
   </div>
   <script>
    document.addEventListener("DOMContentLoaded", function () {
        const table = document.getElementById("leadersTable");
        const tbody = table.querySelector("tbody");
        const searchInput = document.getElementById("searchBox");
        const rowsPerPageSelect = document.getElementById("rowsPerPage");
        const paginationContainer = document.getElementById("pagination");
    
        let currentPage = 1;
        let rowsPerPage = parseInt(rowsPerPageSelect.value);
        let sortColumnIndex = null;
        let sortAscending = true;
    
        // Save the original rows permanently
        let allRows = [];
    
        function getFilteredRows() {
          const filter = searchInput.value.toLowerCase();
          return allRows.filter(row =>
            row.innerText.toLowerCase().includes(filter)
          );
        }
    
        function renderTablePage() {
          let rows = getFilteredRows();
    
          // Sort if applicable
          if (sortColumnIndex !== null) {
            rows.sort((a, b) => {
              const A = a.cells[sortColumnIndex].textContent.toLowerCase();
              const B = b.cells[sortColumnIndex].textContent.toLowerCase();
              return sortAscending ? A.localeCompare(B) : B.localeCompare(A);
            });
          }
    
          const totalPages = Math.ceil(rows.length / rowsPerPage);
          const start = (currentPage - 1) * rowsPerPage;
          const end = start + rowsPerPage;
          const visibleRows = rows.slice(start, end);
    
          // Clear tbody and append only visible rows
          tbody.innerHTML = "";
          visibleRows.forEach(row => tbody.appendChild(row));
    
          renderPagination(totalPages);

          // Update result count
          const resultCount = document.getElementById("resultCount");
          resultCount.textContent = `Showing ${Math.min(end, rows.length)} of ${rows.length} results`;
        }
    
        function renderPagination(totalPages) {
          paginationContainer.innerHTML = "";

          const maxButtons = window.innerWidth <= 500 ? 5 : 10; // Responsive: fewer on mobile
          const half = Math.floor(maxButtons / 2);
          let start = Math.max(1, currentPage - half);
          let end = Math.min(totalPages, start + maxButtons - 1);

          if (end - start < maxButtons - 1) {
            start = Math.max(1, end - maxButtons + 1);
          }
        
          // Previous Button
          if (currentPage > 1) {
            const prevBtn = document.createElement("button");
            prevBtn.textContent = "« Prev";
            prevBtn.addEventListener("click", () => {
              currentPage--;
              renderTablePage();
            });
            paginationContainer.appendChild(prevBtn);
          }
        
          // Page Buttons
          for (let i = start; i <= end; i++) {
            const btn = document.createElement("button");
            btn.textContent = i;
            btn.classList.toggle("active", i === currentPage);
            btn.addEventListener("click", () => {
              currentPage = i;
              renderTablePage();
            });
            paginationContainer.appendChild(btn);
          }
        
          // Next Button
          if (currentPage < totalPages) {
            const nextBtn = document.createElement("button");
            nextBtn.textContent = "Next »";
            nextBtn.addEventListener("click", () => {
              currentPage++;
              renderTablePage();
            });
            paginationContainer.appendChild(nextBtn);
          }
        }

        function sortTable(index) {
          if (sortColumnIndex === index) {
            sortAscending = !sortAscending;
          } else {
            sortColumnIndex = index;
            sortAscending = true;
          }
          currentPage = 1;
          renderTablePage();
        }

        async function populateLeadersTableFromCSV(csvPath) {
          try {
            const response = await fetch(csvPath);
            if (!response.ok) throw new Error("CSV file not found");
          
            const csvText = await response.text();
            const rows = csvText.trim().split("\n");
          
            const tableBody = document.querySelector("#leadersTable tbody");
            tableBody.innerHTML = ""; // Clear existing rows
          
            allRows = []; // Reset the global array
          
            for (const row of rows) {
              const [name, position] = row.split(",");
            
              const tr = document.createElement("tr");
            
              const tdName = document.createElement("td");
              tdName.textContent = name.trim();
            
              const tdPosition = document.createElement("td");
              tdPosition.textContent = position.trim();
            
              tr.appendChild(tdName);
              tr.appendChild(tdPosition);
            
              allRows.push(tr); // Store for pagination
            }
          } catch (error) {
            console.error("Failed to load CSV data:", error);
          }
        }
    
        // Hook up header clicks to sorting
        const headers = table.querySelectorAll("th");
        headers.forEach((th, index) => {
          th.style.cursor = "pointer";
          th.addEventListener("click", () => sortTable(index));
        });
    
        // Input events
        searchInput.addEventListener("input", () => {
          currentPage = 1;
          renderTablePage();
        });
    
        rowsPerPageSelect.addEventListener("change", () => {
          rowsPerPage = parseInt(rowsPerPageSelect.value);
          currentPage = 1;
          renderTablePage();
        });

        // Load CSV and then initialize
        populateLeadersTableFromCSV("reps.csv").then(() => {
          sortColumnIndex = 0;
          sortAscending = true;
          renderTablePage();
        });
      });
   </script>
  </main>
  <!-- Footer links section -->
  <div class="footer-links">
   <a href="https://kansas.gop/" target="_blank">
    Kansas GOP
   </a>
   <a href="https://www.gop.com/" target="_blank">
    Republican National Committee
   </a>
   <a href="donate" target="_blank">
    Donate
   </a>
  </div>
  <!-- Main footer -->
  <!--#include virtual="footer.html" -->
  <div class="footer-disclaimer">
   <p>
    Paid for by the Anderson County Republican Central Committee. Jeremy DuPont, Treasurer.
    <br/>
    412 E 2nd Ave, Garnett, KS 66032
    <br/>
    Not authorized by any candidate or candidates committee.
   </p>
  </div>
 </body>
</html>
